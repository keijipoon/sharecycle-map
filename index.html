<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚·ã‚§ã‚¢ã‚µã‚¤ã‚¯ãƒ«ãƒãƒƒãƒ—</title>
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.13.0/mapbox-gl.css" rel="stylesheet">
    <style>
        /* åŸºæœ¬ã‚¹ã‚¿ã‚¤ãƒ«: bodyã¨htmlã‹ã‚‰ä½™ç™½ã‚’å‰Šé™¤ */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            font-family: 'Noto Sans JP', 'Helvetica Neue', Helvetica, Arial, sans-serif;
        }

        /* ãƒãƒƒãƒ—ã‚³ãƒ³ãƒ†ãƒŠ: ç”»é¢å…¨ä½“ã«è¡¨ç¤º */
        #map {
            position: absolute; /* ä»–ã®è¦ç´ ã¨é‡ã­ã‚‹ãŸã‚ã«çµ¶å¯¾é…ç½® */
            top: 50px; /* â†ãƒ˜ãƒƒãƒ€ãƒ¼ã®é«˜ã•ã«åˆã‚ã›ã¦ */
            bottom: 0;
            width: 100%;
            height: 100%;
        }

        /* â†“ èª¬æ˜ã¨å‡¡ä¾‹ã‚’è¡¨ç¤ºã™ã‚‹ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚³ãƒ³ãƒ†ãƒŠã®ã‚¹ã‚¿ã‚¤ãƒ« */
        #info-overlay {
            position: absolute; /* ãƒãƒƒãƒ—ã®ä¸Šã«é‡ã­ã‚‹ */
            top: 60px; /* ãƒ˜ãƒƒãƒ€ãƒ¼ã«é‡ãªã‚‰ãªã„ã‚ˆã†ã« */
            left: 10px;
            background-color: rgba(255, 255, 255, 0.9); /* åŠé€æ˜ã®ç™½èƒŒæ™¯ */
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 1px 4px rgba(0,0,0,0.3);
            z-index: 1; /* ãƒãƒƒãƒ—ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚ˆã‚Šæ‰‹å‰ã«è¡¨ç¤º */
            max-width: 300px; /* æ¨ªå¹…ãŒåºƒãŒã‚Šã™ããªã„ã‚ˆã†ã« */
        }

        /* â†“ ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤å†…ã®è¦‹å‡ºã—ã‚¹ã‚¿ã‚¤ãƒ« */
        #info-overlay h1 {
            margin: 0 0 10px 0;
            font-size: 1.2em;
            color: #333;
        }

        /* â†“ ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤å†…ã®èª¬æ˜æ–‡ã‚¹ã‚¿ã‚¤ãƒ« */
        #info-overlay p {
            margin: 0 0 15px 0;
            font-size: 0.9em;
            line-height: 1.5;
            color: #555;
        }

        /* â†“ å‡¡ä¾‹ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        #info-overlay .legend h4 {
            margin: 0 0 5px 0;
            font-size: 1em;
            color: #333;
        }
        #info-overlay .legend div {
            margin-bottom: 5px;
            display: flex; /* è‰²è¦‹æœ¬ã¨ãƒ†ã‚­ã‚¹ãƒˆã‚’æ¨ªä¸¦ã³ */
            align-items: center; /* å‚ç›´æ–¹å‘ä¸­å¤®æƒãˆ */
        }
        /* â†“ å‡¡ä¾‹ã®è‰²è¦‹æœ¬ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        #info-overlay .legend span {
            display: inline-block;
            width: 15px;
            height: 15px;
            border-radius: 50%; /* å††å½¢ã«ã™ã‚‹å ´åˆ */
            /* border: 1px solid #ccc; */ /* å¢ƒç•Œç·šãŒå¿…è¦ãªå ´åˆ */
            margin-right: 8px;
            flex-shrink: 0; /* ç¸®ã¾ãªã„ã‚ˆã†ã« */
        }
        #info-overlay .legend span.color-red { /* ã‚¹ã‚¿ã‚¤ãƒ«ã«åˆã‚ã›ã¦ã‚¯ãƒ©ã‚¹åã¨è‰²ã‚’èª¿æ•´ */
            background-color: #E60012; /* ä¾‹: ãƒ‰ã‚³ãƒ¢ãƒ»ãƒã‚¤ã‚¯ã‚·ã‚§ã‚¢ã®ã‚ˆã†ãªèµ¤ */
        }
        #info-overlay .legend span.color-yellow { /* ã‚¹ã‚¿ã‚¤ãƒ«ã«åˆã‚ã›ã¦ã‚¯ãƒ©ã‚¹åã¨è‰²ã‚’èª¿æ•´ */
            background-color: #FFD700; /* ä¾‹: HELLO CYCLINGã®ã‚ˆã†ãªé»„è‰² */
        }
        /* ä»–ã®è‰²ãŒã‚ã‚Œã°ã“ã“ã«è¿½åŠ  */
        #topbar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 50px;
            background-color: rgba(0, 0, 0, 0.7); /* â† çœŸã£é»’ã‹ã‚‰é€æ˜æ„Ÿã®ã‚ã‚‹é»’ã«å¤‰æ›´ */
            color: white;
            display: flex;
            align-items: center;
            justify-content: center; /* â† ã‚¿ã‚¤ãƒˆãƒ«ã‚’ä¸­å¤®å¯„ã›ã«ã™ã‚‹ */
            padding: 0 60px; /* â† å·¦å³ã«ä½™ç™½ã‚’ç¢ºä¿ã—ã¦ã€å³ã®ãƒœã‚¿ãƒ³ãŒã¯ã¿å‡ºã•ãªã„ã‚ˆã†ã«ã™ã‚‹ */
            z-index: 10;
            font-size: 1.1em;
            box-sizing: border-box;
        }

        #topbar-title {
            font-weight: bold;
            flex: 1;
            text-align: center;
        }

        /* Xãƒœã‚¿ãƒ³ã‚’å³ä¸Šã«å›ºå®šé…ç½® */
        #topbar-buttons {
            position: absolute;
            right: 20px;
        }

        #topbar-buttons .share-button {
            background-color: #1da1f2;
            color: white;
            padding: 6px 12px;
            border-radius: 4px;
            text-decoration: none;
            font-size: 0.9em;
        }

        #topbar-buttons .share-button:hover {
            background-color: #0d95e8;
        }



    </style>
</head>
<body>
    <div id="topbar">
        <div id="topbar-title">ğŸš² ã¤ãªãŒã‚‹ã‚·ã‚§ã‚¢ã‚µã‚¤ã‚¯ãƒ«ãƒãƒƒãƒ—ï¼šãƒãƒ¼ãƒˆå°æ•°ã¨è¿‘éš£ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯</div>
        <div id="topbar-buttons">
            <a href="https://twitter.com/intent/tweet?text=ğŸš² ã¤ãªãŒã‚‹ã‚·ã‚§ã‚¢ã‚µã‚¤ã‚¯ãƒ«ãƒãƒƒãƒ—ï¼šãƒãƒ¼ãƒˆå°æ•°ã¨è¿‘éš£ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯&url=https://keijipoon.github.io/sharecycle-map/" target="_blank" class="share-button">Xã§å…±æœ‰</a>
        </div>
    </div>

<div id="info-overlay">
    <h1>ã¤ãªãŒã‚‹ã‚·ã‚§ã‚¢ã‚µã‚¤ã‚¯ãƒ«ãƒãƒƒãƒ—ï¼šãƒãƒ¼ãƒˆå°æ•°ã¨è¿‘éš£ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯</h1>
    <p>
        ã“ã®ãƒãƒƒãƒ—ã§ã¯ã€ä¸»è¦ãªã‚·ã‚§ã‚¢ã‚µã‚¤ã‚¯ãƒ«ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒãƒ¼ãƒˆï¼ˆã‚¹ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ã®ä½ç½®ã‚’ç¢ºèªã§ãã¾ã™ã€‚<br><br>
        ç‰¹å¾´ã¨ã—ã¦ã€1.5kmä»¥å†…ã«ã‚ã‚‹ãƒãƒ¼ãƒˆåŒå£«ã‚’ç·šã§çµã³ã€è‡ªè»¢è»Šã§ã®ç§»å‹•ç¯„å›²ã‚„ã¤ãªãŒã‚Šã‚’è¦–è¦šçš„ã«è¡¨ç¾ã—ã¦ã„ã¾ã™ã€‚<br><br>
        åœ°å›³ã‚’è‡ªç”±ã«æ“ä½œã—ã¦ã€ä¾¿åˆ©ãªãƒãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ã”æ´»ç”¨ãã ã•ã„ã€‚
        </p>
    <div class="legend">
        <h4>å‡¡ä¾‹</h4>
        <div><span class="color-red"></span>ãƒ‰ã‚³ãƒ¢ãƒ»ãƒã‚¤ã‚¯ã‚·ã‚§ã‚¢</div>
        <div><span class="color-yellow"></span>HELLO CYCLING</div>
        </div>
</div>

<div id="map"></div>

<script src="https://api.mapbox.com/mapbox-gl-js/v2.13.0/mapbox-gl.js"></script>
<script>
    // Mapboxã®APIã‚­ãƒ¼ã‚’è¿½åŠ 
    mapboxgl.accessToken = 'pk.eyJ1Ijoia2VpamkiLCJhIjoiY2pvMHZ5ODg4MDRrdjNwcXFwNnA2cWpiZSJ9.lIZIHvCxbduQcrBGEhJ-IQ';
    // åœ°å›³ã®åˆæœŸåŒ–
    const map = new mapboxgl.Map({
        container: 'map', // åœ°å›³ã‚’è¡¨ç¤ºã™ã‚‹è¦ç´ ã®ID
        style: 'mapbox://styles/keiji/clq3vqvpg00o601re68ogfe9w', // Mapbox Studioã§ä½œæˆã—ãŸã‚¹ã‚¿ã‚¤ãƒ«ã®URL
        center: [139.6917, 35.6895], // åœ°å›³ã®åˆæœŸä¸­å¿ƒåº§æ¨™ï¼ˆä¾‹: æ±äº¬ï¼‰
        zoom: 12 // åˆæœŸã‚ºãƒ¼ãƒ ãƒ¬ãƒ™ãƒ«
    });

    // åœ°å›³ã«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’è¿½åŠ ï¼ˆã‚ºãƒ¼ãƒ ã¨å›è»¢ã®ãŸã‚ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ï¼‰
    // â†“ ä½ç½®ã‚’ 'top-right' ãªã©ã«å¤‰æ›´ã—ã¦ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã¨é‡ãªã‚‰ãªã„ã‚ˆã†ã«ã™ã‚‹ (ä»»æ„)
    map.addControl(new mapboxgl.NavigationControl(), 'top-right');

    // ã‚¹ã‚±ãƒ¼ãƒ«ãƒãƒ¼ã®è¿½åŠ 
    const scale = new mapboxgl.ScaleControl({
        maxWidth: 80,
        unit: 'metric' // ãƒ¡ãƒ¼ãƒˆãƒ«å˜ä½
    });
    // â†“ ä½ç½®ã‚’ 'bottom-left' ãªã©ã«å¤‰æ›´ã—ã¦ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã¨é‡ãªã‚‰ãªã„ã‚ˆã†ã«ã™ã‚‹ (ä»»æ„)
    map.addControl(scale, 'bottom-left');

    // åœ°å›³ãŒãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸã‚‰ã€ã‚¹ã‚±ãƒ¼ãƒ«ãƒãƒ¼ã‚’æ›´æ–°
    map.on('load', () => {
        scale.setUnit('metric'); // ãƒ¡ãƒ¼ãƒˆãƒ«å˜ä½ã«è¨­å®š
    });

    // ç¾åœ¨ä½ç½®ãƒœã‚¿ãƒ³ï¼ˆGeolocateControlï¼‰ã‚’è¿½åŠ 
    const geolocateControl = new mapboxgl.GeolocateControl({
        positionOptions: {
            enableHighAccuracy: true // é«˜ç²¾åº¦ã§ä½ç½®æƒ…å ±ã‚’å–å¾—
        },
        trackUserLocation: true, // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½ç½®ã‚’è¿½è·¡
        showUserLocation: true // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½ç½®ã«ãƒãƒ¼ã‚«ãƒ¼ã‚’è¡¨ç¤º
    });
    // â†“ ä½ç½®ã‚’ 'top-right' ãªã©ã«å¤‰æ›´ã—ã¦ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã¨é‡ãªã‚‰ãªã„ã‚ˆã†ã«ã™ã‚‹ (ä»»æ„)
    map.addControl(geolocateControl, 'top-right');

    // åœ°å›³ãŒèª­ã¿è¾¼ã¾ã‚ŒãŸã‚‰ã€ç¾åœ¨ä½ç½®ã‚’è‡ªå‹•çš„ã«å–å¾—ã—ã¦ç§»å‹•
    map.on('load', () => {
        // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ‰‹å‹•ã§ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã®ã‚’å¾…ã¤å ´åˆã¯ã€ä»¥ä¸‹ã®è¡Œã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã¾ãŸã¯å‰Šé™¤
        // geolocateControl.trigger();
    });

    // --- ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—è¡¨ç¤ºã®è¿½åŠ ä¾‹ (ã‚‚ã—Mapbox Studioã§è¨­å®šã—ã¦ã„ãªã„å ´åˆ) ---
    // Mapbox Studio ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼åã«åˆã‚ã›ã¦ãã ã•ã„ (ä¾‹: 'share-cycle-ports')
    const layerName = 'share-cycle-ports'; // å®Ÿéš›ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼åã«ç½®ãæ›ãˆã‚‹

    // map.on('load', ...) ã®ä¸­ã‚„ã€åœ°å›³ãŒå®Œå…¨ã«ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸå¾Œã«è¿½åŠ 
    /*
    map.on('load', () => {
        // ... æ—¢å­˜ã® load ã‚¤ãƒ™ãƒ³ãƒˆå†…ã®å‡¦ç† ...

        // ãƒãƒ¼ãƒˆãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª
        if (map.getLayer(layerName)) {
            // ãƒã‚¦ã‚¹ã‚«ãƒ¼ã‚½ãƒ«ã‚’ãƒã‚¤ãƒ³ã‚¿ãƒ¼ã«å¤‰æ›´
            map.on('mouseenter', layerName, () => {
                map.getCanvas().style.cursor = 'pointer';
            });
            map.on('mouseleave', layerName, () => {
                map.getCanvas().style.cursor = '';
            });

            // ã‚¯ãƒªãƒƒã‚¯æ™‚ã«ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’è¡¨ç¤º
            map.on('click', layerName, (e) => {
                // ã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸãƒ•ã‚£ãƒ¼ãƒãƒ£ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å–å¾—
                const coordinates = e.features[0].geometry.coordinates.slice();
                const properties = e.features[0].properties;

                // ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åã‚’å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã«åˆã‚ã›ã¦ãã ã•ã„ (ä¾‹: name, service, bikes_available)
                const description = `
                    <h3>${properties.name || 'åç§°æœªè¨­å®š'}</h3>
                    <p>ã‚µãƒ¼ãƒ“ã‚¹: ${properties.service || 'ä¸æ˜'}</p>
                    <p>åˆ©ç”¨å¯èƒ½å°æ•°: ${properties.bikes_available !== undefined ? properties.bikes_available : 'ä¸æ˜'}</p>
                `;

                // Ensure that if the map is zoomed out such that multiple
                // copies of the feature are visible, the popup appears
                // over the copy being pointed to.
                while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
                    coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
                }

                new mapboxgl.Popup()
                    .setLngLat(coordinates)
                    .setHTML(description)
                    .addTo(map);
            });
        } else {
            console.warn(`Layer "${layerName}" not found in the style.`);
        }
    });
    */

</script>

</body>
</html>